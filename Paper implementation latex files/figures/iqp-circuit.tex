%%% ============================================================
%%% FIGURE: IQP Feature Map Circuit Diagram
%%% ============================================================
%%% Include in main document with: \input{figures/iqp-circuit}
%%% or reference as: \ref{fig:iqp-circuit}
%%% ============================================================

\begin{figure}[t]
\centering
\begin{quantikz}[row sep=0.4cm, column sep=0.4cm]
\lstick{$\ket{0}_1$} & \gate{H} & \gate{R_Z(\theta_1)} & \ctrl{1}               & \qw                    & \qw      & \gate{H} & \meter{} \\
\lstick{$\ket{0}_2$} & \gate{H} & \gate{R_Z(\theta_2)} & \gate{\text{CP}_{12}}  & \ctrl{1}               & \qw      & \gate{H} & \meter{} \\
\lstick{$\ket{0}_3$} & \gate{H} & \gate{R_Z(\theta_3)} & \qw                    & \gate{\text{CP}_{23}}  & \ctrl{1} & \gate{H} & \meter{} \\
\lstick{$\ket{0}_n$} & \gate{H} & \gate{R_Z(\theta_n)} & \qw                    & \qw                    & \gate{\text{CP}_{(n\text{-}1)n}} & \gate{H} & \meter{}
\end{quantikz}
\caption{Circuit diagram of the IQP feature map $U_{\text{IQP}}(\boldsymbol{\theta}) = H^{\otimes n} \cdot D(\boldsymbol{\theta}) \cdot H^{\otimes n}$. The first and last columns of Hadamard gates implement $H^{\otimes n}$, while the central gates ($R_Z$ rotations and controlled-phase gates) form the diagonal block $D(\boldsymbol{\theta})$. All gates within $D(\boldsymbol{\theta})$ commute, making the circuit instantaneous. In our experiments, $n = 6$ and $\theta_j = x_j$, $\theta_{jk} = (\pi - x_j)(\pi - x_k)$.}\label{fig:iqp-circuit}
\end{figure}
